# 基于vue-admin-template二次开发的人力资源管理系统

# 整体架构

基于 `vue-admin-template` 模板二次开发的中台管理系统，引入 `vuex` ，`vue-router` ，`element-ui` 等工具。

通过一级路由，设计两个大的路由组件，分别是登录页和主页，主页又分为侧边栏，导航栏，内容区域。

通过二级路由，在主页的内容区域设计多个路由组件，根据侧边栏的不同进行展示。

- 登录页
- 主页
  - 侧边栏
  - 导航栏
  - 内容区域

# api模块的封装

在项目中需要使用 `axios` 的拦截器，因此封装一个请求工具 `utils/request.js` ，在里面创建一个 `axios` 实例，并挂载拦截器，然后导出这个实例。

在 `api/user.js` 中导入封装的 `request.js` ，然后对每个接口都单独导出一个方法，方便后续的使用。

# 开发环境的跨域问题

在 `vue-cli` 下开发启动的服务，访问接口时出现跨域问题，通过 `vue-cli` 在本地开启的服务代理跨域请求，解决跨域问题。

在配置文件 `vue.config.js` 中配置代理。

原理是通过本地的后端代理向另一个服务器发送请求，也就不存在前端跨域的问题。

# 通过 vuex 管理 token

对于 `token` 这个高频使用的钥匙，使用 `vuex` 管理用户的 `token` 状态，方便共享使用。

点击登录时，在 `vuex` 中的 `actions` 中发起登录请求，获取 `token` 后通过 `mutations` 更新 `token` ，表示登录成功，然后跳转主页。

初始化时从缓存中读取 `token` ，并赋值到状态上。

在 `mutations` 中声明设置 `token` 和删除 `token` 的方法，并在方法中同步 `vuex` 状态和本地缓存。

在 `actions` 中声明登录方法，调用登录接口，成功后设置 `token` 到 `vuex` ，失败返回失败。

在响应拦截器中，处理请求失败的情况，如果请求成功，解构赋值返回的数据。

# 权限拦截流程

访问权限拦截，当访问某个页面时，先检查是否有token，如果有token，判断是否访问登录页，如果访问登录页则跳转到主页，如果访问其他页面则直接放行。如果没有token，判断是否访问白名单，如果访问白名单则直接放行，如果访问其他页面则跳转到登录页。